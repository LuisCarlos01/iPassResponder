{% extends 'base.html' %}

{% block title %}Configurações{% endblock %}

{% block content %}
<h4 class="mb-4">Configurações</h4>

<div class="row">
    <div class="col-lg-8">
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title mb-3">Configurações de Email</h5>
                
                <div class="mb-4">
                    <h6 class="mb-2">Método de Autenticação:</h6>
                    <div class="d-flex">
                        <div class="me-3">
                            <a href="{{ url_for('auth_gmail') }}" class="btn btn-primary">
                                Autenticar com Google
                            </a>
                            <div class="form-text small">Método recomendado para contas Gmail</div>
                        </div>
                        
                        <div>
                            <button type="button" class="btn btn-outline-secondary" data-bs-toggle="collapse" data-bs-target="#credentialsForm">
                                Usar Senha de App
                            </button>
                            <div class="form-text small">Para outros provedores de email</div>
                        </div>
                    </div>
                </div>

                <form method="post" action="{{ url_for('settings') }}" class="collapse" id="credentialsForm">
                    <div class="alert alert-info py-2 small">
                        Para contas Gmail, use uma "senha de app" em vez da senha normal.
                        <a href="https://support.google.com/accounts/answer/185833" target="_blank" class="alert-link">
                            Criar senha de app
                        </a>
                    </div>

                    <div class="mb-3">
                        <label for="email_user" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email_user" name="email_user" 
                               value="{{ env_vars.EMAIL_USUARIO }}" required>
                    </div>

                    <div class="mb-3">
                        <label for="email_password" class="form-label">Senha</label>
                        <input type="password" class="form-control" id="email_password" name="email_password" required>
                        <div class="form-text small">Use sua senha normal ou senha de app para Gmail.</div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="imap_server" class="form-label">Servidor IMAP</label>
                            <input type="text" class="form-control" id="imap_server" name="imap_server" 
                                   value="{{ env_vars.SERVIDOR_IMAP }}" required>
                        </div>
                        <div class="col-md-4">
                            <label for="smtp_server" class="form-label">Servidor SMTP</label>
                            <input type="text" class="form-control" id="smtp_server" name="smtp_server" 
                                   value="{{ env_vars.SERVIDOR_SMTP }}" required>
                        </div>
                        <div class="col-md-4">
                            <label for="smtp_port" class="form-label">Porta SMTP</label>
                            <input type="number" class="form-control" id="smtp_port" name="smtp_port" 
                                   value="{{ env_vars.PORTA_SMTP }}" required>
                        </div>
                    </div>

                    <div class="mt-3">
                        <button type="submit" class="btn btn-primary">
                            Salvar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title mb-3">Servidores Comuns</h5>
                
                <div class="mb-3">
                    <h6 class="mb-1 small fw-bold">Gmail</h6>
                    <div class="ps-2 text-muted small">
                        IMAP: imap.gmail.com<br>
                        SMTP: smtp.gmail.com<br>
                        Porta: 587<br>
                        <span class="text-warning">Requer senha de app</span>
                    </div>
                </div>
                
                <div class="mb-3">
                    <h6 class="mb-1 small fw-bold">Outlook/Hotmail</h6>
                    <div class="ps-2 text-muted small">
                        IMAP: outlook.office365.com<br>
                        SMTP: smtp.office365.com<br>
                        Porta: 587
                    </div>
                </div>
                
                <div>
                    <h6 class="mb-1 small fw-bold">Yahoo</h6>
                    <div class="ps-2 text-muted small">
                        IMAP: imap.mail.yahoo.com<br>
                        SMTP: smtp.mail.yahoo.com<br>
                        Porta: 587
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}